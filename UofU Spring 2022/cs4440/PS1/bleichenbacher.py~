from roots import *
import hashlib
import sys
import base64
import subprocess
message = sys.argv[1]

#n = 0x00b06004b3528bfd2d187f48e6cb9f3fe79afade6cc3c428dd0577b8bb3e752824b632d100d28b396726a887c5189ded3fe9717d959730dadbf468b2bc76eea3c15091a38b61fdfa46b1510ef885ea3105ae7d7f3007e97c6761bc47e715ba32464c77f7d0cfd2c88c0f53d45404a110d6951d3f4255edc3523921237a86f35fed200c7e45870b822d7652dc896d0de064617dbb48eb9b1d47103f12911b0dab3d91e0fdb847f0b87cf2b20b19d3b951cae86cab611893f6f4cd016c68607e970fc2db800f981d9bb4441fe5d70299693a8ae51f2e9b2656f0c279bf87ecb96a753f231739eb1f9a9d7dd01f15f283dd2da2887e7fdef6aedd61c4ca7b3be1b1cd


subprocess.call(f"echo {message} > inputStr", shell=True)
b64Encoded = base64.encode(inputStr, outputEncoded)
    


forged_signature = integer_nthroot(message, 3)[0]

m = hashlib.sha1()
m.update(forged_signature.encode())


print(integer_to_base64(forged_signature))
